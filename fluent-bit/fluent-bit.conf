# Updated Fluent Bit Configuration
[SERVICE]
    Flush        1
    Daemon       off
    Log_Level    info
    HTTP_Server  On
    HTTP_Listen  0.0.0.0
    HTTP_Port    2020

# Standard input for fluent-forward protocol
[INPUT]
    Name        forward
    Listen      0.0.0.0
    Port        24224
    Buffer_Chunk_Size  1M
    Buffer_Max_Size    6M

# Standard output for viewing logs in container logs
[OUTPUT]
    Name        stdout
    Match       *
    Format      json_lines
    json_date_key timestamp
    json_date_format iso8601

# ALL logs
[OUTPUT]
    Name        file
    Match       *
    Path        /fluent-bit/logs/
    File        application.log
    Format      json_lines

# Create a filter for errors and warnings
[FILTER]
    Name        grep
    Match       *
    Regex       level (error|warn)
    Alias       errors_filter

# Output only errors and warnings to a separate file
[OUTPUT]
    Name        file
    Match_Regex errors_filter
    Path        /fluent-bit/logs/
    File        errors.log
    Format      json_lines

# Create a filter for performance logs
[FILTER]
    Name        grep
    Match       *
    Regex       context Performance
    Alias       performance_filter

# Output performance logs to a separate file
[OUTPUT]
    Name        file
    Match_Regex performance_filter
    Path        /fluent-bit/logs/
    File        performance.log
    Format      json_lines

# Create a filter for database logs
[FILTER]
    Name        grep
    Match       *
    Regex       context (Database|Prisma)
    Alias       database_filter

# Output database logs to a separate file
[OUTPUT]
    Name        file
    Match_Regex database_filter
    Path        /fluent-bit/logs/
    File        database.log
    Format      json_lines

# Create a filter for HTTP request/response logs
[FILTER]
    Name        grep
    Match       *
    Regex       context (HTTP Request|HTTP Response)
    Alias       http_filter

# Output HTTP logs to a separate file
[OUTPUT]
    Name        file
    Match_Regex http_filter
    Path        /fluent-bit/logs/
    File        http.log
    Format      json_lines