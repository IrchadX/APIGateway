[SERVICE]
    Flush             1
    Daemon            Off
    Log_Level         info
    HTTP_Server       On
    HTTP_Listen       0.0.0.0
    HTTP_Port         2020

# For HTTP input
[INPUT]
    Name              http
    Listen            0.0.0.0
    Port              24224
    Tag               nest

# For TCP input (alternative)
[INPUT]
    Name              forward
    Listen            0.0.0.0
    Port              24225
    Tag               nest

# Parse JSON logs
[FILTER]
    Name              parser
    Match             nest.*
    Key_Name          data
    Parser            json
    Reserve_Data      On

# Create multiple outputs - stdout and file
[OUTPUT]
    Name              stdout
    Match             *
    Format            json_lines

# File output for all logs
[OUTPUT]
    Name              file
    Match             *
    Path              /logs
    File              fluent_all.log
    Format            json_lines

# File output for errors only
[OUTPUT]
    Name              file
    Match             nest.error
    Path              /logs
    File              fluent_error.log
    Format            json_lines

# Separate file for each log level
[OUTPUT]
    Name              file
    Match             nest.info
    Path              /logs
    File              fluent_info.log
    Format            json_lines

[OUTPUT]
    Name              file
    Match             nest.warn
    Path              /logs
    File              fluent_warn.log
    Format            json_lines

# PARSERS
[PARSER]
    Name              json
    Format            json
    Time_Key          timestamp
    Time_Format       %Y-%m-%dT%H:%M:%S.%L%z